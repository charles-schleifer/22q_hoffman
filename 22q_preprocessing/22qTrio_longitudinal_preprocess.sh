#!/bin/sh

# C. Schleifer 1/1/22
# Script to run FS longitudinal pipeline for Trio data and integrate with qunex preprocessing
# Must have run qunex preprocessing through at least hcp1
# Script should not be run directly. Execute functions one by one


#####################################################################
### batch run all trio subjects
#####################################################################
## STEP 1: first run of recon-all completed during hcp_freesurfer
# copy freesurfer data to longitudinal dir
origdir="/u/project/cbearden/data/22q/qunex_studyfolder/sessions"
longdir="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
for path in ${origdir}/Q_*;do sesh=$(basename ${path}); cp -rv ${origdir}/${sesh}/hcp/${sesh}/T1w/${sesh} ${longdir};done

## STEP 2: create base template
# get list of subject ids
origdir="/u/project/cbearden/data/22q/qunex_studyfolder/sessions"
longdir="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
for i in ${origdir}/Q_* ;do sesh=$(basename $i); sub=${sesh%_*}; echo $sub;done | sort | uniq > ${longdir}/subject_ids_unique.txt
# read list back as array
#subject_array=($(cat ${longdir}/subject_ids_unique.txt))
subject_array=($(cat ${longdir}/subject_ids_rerun.txt))
SUBJECTS_DIR=${longdir}
#fs_command="recon-all -long Q_0039 -tp Q_0039_04132010 -tp Q_0039_06012011 -all"
fstmp=~/"fstmp"
cfstmp=~/"cfstmp"
echo "...writing temporary freesurfer command file:"
# lines below write temporary code to be execited in container
# first source qunex environment
echo "source /opt/qunex/env/qunex_environment.sh" > ${fstmp}
# set FS subjects dir in the container based on subjects dir in current shell
echo "SUBJECTS_DIR=${SUBJECTS_DIR}" >> ${fstmp}
# read subject list into array
#echo "subject_array=(\$(cat \${SUBJECTS_DIR}/subject_ids_unique.txt))" >> ${fstmp}
# read re-run subject array instead
echo "subject_array=(\$(cat \${SUBJECTS_DIR}/subject_ids_rerun.txt))" >> ${fstmp}
# get SGE_TASK_ID passed as arg1 from submitting script
echo "sge_i=\$1" >> ${fstmp}
# array starts at 0, sge index starts at 1
echo "n=\$((\${sge_i} - 1))" >> ${fstmp}
echo "echo n=\$n" >> ${fstmp}
# get subject based on sge index
echo "sub=\${subject_array[\$n]}" >> ${fstmp}
# construct freesurfer command adding -tp <sesh> for every session
echo "tplist=\"\"" >> ${fstmp}
echo "for i in ${origdir}/\${sub}*;do sesh=\$(basename \${i});tplist=\"\${tplist} -tp \${sesh}\";done" >> ${fstmp}
echo "fs_command=\"recon-all -base \${sub} \${tplist} -all\"" >> ${fstmp}
# run freesurfer command
echo "\${fs_command}" >> ${fstmp}
# cleanup
#echo "echo \" \" > ${fstmp}" >> ${fstmp}
#echo "echo \" \" > ${cfstmp}" >> ${fstmp}
# now set up temp file to to create container
echo "...writing temporary singularity command file:"
# check that SGE_TASK_ID is set
echo "if [[ -z \$SGE_TASK_ID ]];then echo \"SGE_TASK_ID empty. Make sure you are submitting as array\"; exit 0;fi" > ${cfstmp}
# make sure singularity is loaded
echo "source /u/local/Modules/default/init/modules.sh" >> ${cfstmp}
echo "module load singularity"    >> ${cfstmp}
# run fstmp code in singularity container and give it sge index as arg1 
echo "singularity exec --userns /u/project/cbearden/data/scripts/tools/qunex_suite-0.90.6/ bash ${fstmp} \$SGE_TASK_ID" >> ${cfstmp}
# print code
echo "Code to be run inside the container:"
cat ${fstmp}
echo ""
echo "Code to create container:"
cat ${cfstmp}
# submit array to scheduler
length=${#subject_array[@]}
qsub -cwd -V -N fslong.step2.base -o ${SUBJECTS_DIR}/fs_logs -e ${SUBJECTS_DIR}/fs_logs -t 1-${length}:1 -l h_data=16G,h_rt=36:00:00,highp $cfstmp

# ran out of disk space while running. subjects below finished without error:
done_subs="Q_0001 Q_0026 Q_0033 Q_0036 Q_0037 Q_0038 Q_0039 Q_0040 Q_0041 Q_0045 Q_0051 Q_0005 Q_0052 Q_0053 Q_0054 Q_0056 Q_0059 Q_0062 Q_0076 Q_0077 Q_0078 Q_0080 Q_0007 Q_0081 Q_0082 Q_0085 Q_0091 Q_0092 Q_0093 Q_0098 Q_0099 Q_0100 Q_0101 Q_0009 Q_0102 Q_0103 Q_0105 Q_0109 Q_0112 Q_0114 Q_0117 Q_0118 Q_0124 Q_0126 Q_0016 Q_0127 Q_0130 Q_0132 Q_0135 Q_0136 Q_0137 Q_0138 Q_0141 Q_0146 Q_0147 Q_0019 Q_0149 Q_0150 Q_0151 Q_0153 Q_0156 Q_0157 Q_0159 Q_0161 Q_0162 Q_0163 Q_0020 Q_0166 Q_0168 Q_0169 Q_0170 Q_0171 Q_0172 Q_0173 Q_0174 Q_0176 Q_0177 Q_0021 Q_0178 Q_0182 Q_0184 Q_0189 Q_0190 Q_0192 Q_0024 Q_0200 Q_0213 Q_0217 Q_0219 Q_0222"
# get list of subjects that didn't finish
for i in ${subject_array[@]}; do if [[ ${done_subs} != *${i}*  ]];then echo $i ;fi;done > ${longdir}/subject_ids_rerun.txt
rerun_subs=($(cat ${longdir}/subject_ids_rerun.txt))
#rerun_subs="Q_0185 Q_0186 Q_0188 Q_0196 Q_0215 Q_0216 Q_0223 Q_0227 Q_0228 Q_0229 Q_0232 Q_0234 Q_0236 Q_0238 Q_0240 Q_0242 Q_0244 Q_0246 Q_0252 Q_0255 Q_0260 Q_0266 Q_0268 Q_0269 Q_0277 Q_0284 Q_0285 Q_0286 Q_0287 Q_0291 Q_0307 Q_0310 Q_0311 Q_0315 Q_0321 Q_0322 Q_0326 Q_0327 Q_0328"
# delete template dirs for unfinished subjects
for i in ${rerun_subs[@]};do rm -rfv ${longdir}/${i};done
# rerun STEP 2 above pointing subject_array to subject_ids_rerun

## STEP 3: longitudinally process each timepoint
# get list of subject ids
origdir="/u/project/cbearden/data/22q/qunex_studyfolder/sessions"
longdir="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
for i in ${origdir}/Q_* ;do sesh=$(basename $i); echo $sesh;done | sort | uniq > ${longdir}/session_ids_unique.txt
# read list back as array
sesh_array=($(cat ${longdir}/session_ids_unique.txt))
SUBJECTS_DIR=${longdir}
fstmp=~/"fstmp"
cfstmp=~/"cfstmp"
echo "...writing temporary freesurfer command file:"
# lines below write temporary code to be execited in container
# first source qunex environment
echo "source /opt/qunex/env/qunex_environment.sh" > ${fstmp}
# set FS subjects dir in the container based on subjects dir in current shell
echo "SUBJECTS_DIR=${SUBJECTS_DIR}" >> ${fstmp}
# read subject list into array
echo "sesh_array=(\$(cat \${SUBJECTS_DIR}/session_ids_unique.txt))" >> ${fstmp}
# get SGE_TASK_ID passed as arg1 from submitting script
echo "sge_i=\$1" >> ${fstmp}
# array starts at 0, sge index starts at 1
echo "n=\$((\${sge_i} - 1))" >> ${fstmp}
# get subject based on sge index
echo "sesh=\${sesh_array[\$n]}" >> ${fstmp}
echo "sub=\${sesh%_*}" >> ${fstmp}
# construct freesurfer command
echo "fs_command=\"recon-all -long \${sesh} \${sub} -all\"" >> ${fstmp}
# run freesurfer command
echo "\${fs_command}" >> ${fstmp}
# cleanup
#echo "echo \" \" > ${fstmp}" >> ${fstmp}
#echo "echo \" \" > ${cfstmp}" >> ${fstmp}
# now set up temp file to to create container
echo "...writing temporary singularity command file:"
# check that SGE_TASK_ID is set
echo "if [[ -z \$SGE_TASK_ID ]];then echo \"SGE_TASK_ID empty. Make sure you are submitting as array\"; exit 0;fi" > ${cfstmp}
# make sure singularity is loaded
echo "source /u/local/Modules/default/init/modules.sh" >> ${cfstmp}
echo "module load singularity"    >> ${cfstmp}
# run fstmp code in singularity container and give it sge index as arg1 
echo "singularity exec --userns /u/project/cbearden/data/scripts/tools/qunex_suite-0.90.6/ bash ~/fstmp \$SGE_TASK_ID" >> ${cfstmp}
# print code
echo "Code to be run inside the container:"
cat ${fstmp}
echo ""
echo "Code to create container:"
cat ${cfstmp}
# submit array to schedulerlength=1
length=${#sesh_array[@]}
qsub -cwd -V -N fslong.step3.long -o ${SUBJECTS_DIR}/fs_logs -e ${SUBJECTS_DIR}/fs_logs -t 1-${length}:1 -l h_data=16G,h_rt=24:00:00,highp $cfstmp


## STEP 4 prepare to continue hcp processing after fs-longitudinal
# make directory 
origdir="/u/project/cbearden/data/22q/qunex_studyfolder/sessions"
longdir="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
postlongdir="/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions"
mkdir -p $postlongdir
cd $postlongdir

# copy over hcp directory structure
# first manually make script that copies over all files in files_after_hcp1.txt taking a session id as input
# commented out commands below are attempt to do it less manually but were abandoned
# get session id from arg1
#echo "sesh=\$1" > /u/project/cbearden/data/22q/qunex_studyfolder/processing/scripts/copy_hcp1_for_post_longitudinal.sh
# copy files_aftr_hcp1.txt into a set of commands for copying each file for $sesh to $postlongdir
#target=$(echo "${postlongdir}/" | sed 's/\//\\\//g')
#cat /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp1.txt | sed 's/Q_0039_04132010/\${sesh}/g' | sed 's/^/cp -v\ /g' | sed s/$/\ ${target}/g 

# then loop through all sessions and copy hcp1 results to post_long_sessions dir
sesh_array=($(cat ${longdir}/session_ids_unique.txt))
for sesh in ${sesh_array[@]}; do bash /u/project/cbearden/data/22q/qunex_studyfolder/processing/scripts/copy_hcp1_for_post_longitudinal.sh ${sesh};done

# now copy freesurfer long results into post long directory
for sesh in ${sesh_array[@]}; do cp -rv ${longdir}/${sesh}.long.${sesh%_*} ${postlongdir}/${sesh}/hcp/${sesh}/T1w/${sesh};done

# copy session_hcp.txt and change paths
for sesh in ${sesh_array[@]}; do cat ${origdir}/${sesh}/session_hcp.txt | sed 's/sessions/post_long_sessions/g' > ${postlongdir}/${sesh}/session_hcp.txt;done

# create batch file for post longitudinal processing
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="create_batch" \
--qunex_options="--targetfile=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --overwrite=no --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions --sourcefiles=session_hcp.txt --paramfile=/u/project/cbearden/data/22q/qunex_studyfolder/sessions/specs/22q_trio_params.txt --sessions=Q_0001_09242012,Q_0001_10152010,Q_0005_04182011,Q_0007_04012011,Q_0009_09292011,Q_0016_03292011,Q_0016_10082012,Q_0019_05052011,Q_0020_03262012,Q_0020_05052011,Q_0021_01132011,Q_0021_11052012,Q_0024_04152011,Q_0024_09212012,Q_0026_03232012,Q_0026_05032013,Q_0033_03192010,Q_0036_03302010,Q_0036_06212012,Q_0036_06282011,Q_0037_04202011,Q_0038_06042010,Q_0039_04132010,Q_0039_06012011,Q_0040_05142010,Q_0040_06272011,Q_0041_09262012,Q_0045_07132010,Q_0045_08302011,Q_0045_10052012,Q_0051_01302012,Q_0052_07302010,Q_0053_08022010,Q_0053_12212012,Q_0054_08062010,Q_0056_08252010,Q_0056_09102012,Q_0059_08032011,Q_0062_11302011,Q_0076_10212010,Q_0077_02292012,Q_0077_03112013,Q_0077_10252010,Q_0078_11102011,Q_0080_11222010,Q_0081_11242010,Q_0082_01062012,Q_0082_01112013,Q_0082_12162010,Q_0085_02242012,Q_0091_03052012,Q_0091_03072011,Q_0092_03102011,Q_0093_03082011,Q_0093_03122012,Q_0093_03122013,Q_0098_04012011,Q_0099_04012011,Q_0100_04082011,Q_0101_01032013,Q_0101_04122011,Q_0102_01032013,Q_0102_04122011,Q_0103_04182011,Q_0103_08272012,Q_0105_05022011,Q_0109_05262011,Q_0112_11142012,Q_0114_02062014,Q_0114_11092012,Q_0117_07062011,Q_0117_08312012,Q_0118_07072011,Q_0124_07292011,Q_0124_09172012,Q_0126_08012011,Q_0127_03052013,Q_0127_08012014,Q_0127_08082011,Q_0130_08132012,Q_0130_08162011,Q_0130_11042014,Q_0132_08222011,Q_0135_09012011,Q_0136_09012011,Q_0137_09022011,Q_0138_09032013,Q_0138_09042012,Q_0138_09062011,Q_0141_10072013,Q_0141_10092012,Q_0146_11082012,Q_0146_12072011,Q_0147_08112015,Q_0147_08142014,Q_0147_12122011,Q_0149_11192012,Q_0149_12192011,Q_0150_11192012,Q_0150_12202011,Q_0151_01122012,Q_0153_01202012,Q_0156_01312012,Q_0156_12102013,Q_0157_01312012,Q_0159_02122013,Q_0161_03012012,Q_0161_04192013,Q_0162_03202012,Q_0163_03262012,Q_0166_01092014,Q_0166_04052012,Q_0168_04052012,Q_0169_04062012,Q_0170_04102012,Q_0170_11252014,Q_0171_04102012,Q_0171_11252014,Q_0172_04122012,Q_0172_04262013,Q_0173_04122012,Q_0173_04172014,Q_0173_04262013,Q_0174_04182012,Q_0174_04272015,Q_0176_04242012,Q_0176_05072013,Q_0177_05012012,Q_0178_05012012,Q_0182_05182012,Q_0184_05242012,Q_0185_05242012,Q_0186_04092015,Q_0188_05242012,Q_0189_05242012,Q_0190_06012012,Q_0190_08132013,Q_0192_06112013,Q_0196_06192015,Q_0196_06202012,Q_0196_09122013,Q_0200_04032015,Q_0200_07092012,Q_0200_08052013,Q_0213_08032012,Q_0215_08062012,Q_0215_08172015,Q_0216_08062012,Q_0216_08172015,Q_0217_01142014,Q_0217_02042015,Q_0217_08092012,Q_0219_08122014,Q_0219_08162012,Q_0219_09012015,Q_0222_08212012,Q_0223_08212012,Q_0227_10032012,Q_0228_01292014,Q_0228_09272012,Q_0229_10022012,Q_0232_12122012,Q_0234_03252014,Q_0234_12132012,Q_0236_03072013,Q_0238_03202013,Q_0238_08042014,Q_0238_11132015,Q_0240_03232015,Q_0240_03272013,Q_0240_06262014,Q_0242_03272013,Q_0242_05162016,Q_0244_09162013,Q_0244_09232014,Q_0246_09242013,Q_0252_12102013,Q_0255_10212014,Q_0260_06092014,Q_0260_10262015,Q_0266_08122014,Q_0268_10132014,Q_0269_10142014,Q_0277_12082014,Q_0284_03182015,Q_0285_03182015,Q_0286_03182015,Q_0287_03182015,Q_0291_04172015,Q_0307_10132015,Q_0310_11182015,Q_0311_12082015,Q_0315_01262016,Q_0321_03232016,Q_0322_03312016,Q_0326_04142016,Q_0327_04142016,Q_0328_04262016" \
--scheduler_options="-l h_data=4G,h_rt=1:00:00" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual/" \
--array="no" 


## STEP 5: continue hcp processing starting with hcp3

# 5.1 post freesurfer
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="hcp_post_freesurfer" \
--qunex_options="--sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions --parsessions=1 --overwrite=no" \
--scheduler_options="-l h_data=16G,h_rt=24:00:00,arch=intel*" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual/" \
--array="yes" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

# 5.2 copy over eye.dat files
# BOLD volume was failing during DistortionCorrectionAndEPIToT1wReg_FLIRTBBRAndFreeSurferBBRbased.sh because it couldn't find post_long_sessions/$sesh/hcp/$sesh/T1w/$sesh/mri/transforms/eye.dat
# this file is just a text file that shouldn't differ with longitudinal processing, so can copy from cross sectional sessions dir
# see freesurfer script for contents of eye.dat text file: https://github.com/Washington-University/HCPpipelines/blob/master/FreeSurfer/FreeSurferPipeline.sh
sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"
for sesh in $sessions; do cp -v /u/project/cbearden/data/22q/qunex_studyfolder/sessions/${sesh}/hcp/${sesh}/T1w/${sesh}/mri/transforms/eye.dat /u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions/${sesh}/hcp/${sesh}/T1w/${sesh}/mri/transforms/eye.dat;done

# 5.3 generate surfaces not made by fs.long
# BOLD volume fails because post_long is missing /u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions/Q_0001_09242012/hcp/Q_0001_09242012/T1w/Q_0001_09242012/surf/lh.white.deformed
# this surface is generated in hcp freesurfer step to aid in registration of fMRI and diffusion
# https://github.com/Washington-University/HCPpipelines/blob/master/FreeSurfer/FreeSurferPipeline.sh
# first request a node and enter singularity container to run interactively
qrsh -l h_rt=24:00:00,h_data=32G,arch=intel*
screen
module load singularity
singularity run --userns /u/project/cbearden/data/scripts/tools/qunex_suite-0.90.6
# list of sessions
sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"
for sesh in $sessions; do
echo $sesh
    SUBJECTS_DIR=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions/${sesh}/hcp/${sesh}/T1w/
    tkregister2 --mov ${SUBJECTS_DIR}/${sesh}/mri/rawavg.mgz --targ ${SUBJECTS_DIR}/${sesh}/mri/orig.mgz --noedit --regheader --reg ${SUBJECTS_DIR}/${sesh}/mri/transforms/orig2rawavg.dat
    mri_surf2surf --s ${sesh} --sval-xyz white --reg  ${SUBJECTS_DIR}/${sesh}/mri/transforms/orig2rawavg.dat --tval-xyz  ${SUBJECTS_DIR}/${sesh}/mri/rawavg.mgz --tval white.deformed --surfreg white --hemi lh
    mri_surf2surf --s ${sesh} --sval-xyz white --reg  ${SUBJECTS_DIR}/${sesh}/mri/transforms/orig2rawavg.dat --tval-xyz  ${SUBJECTS_DIR}/${sesh}/mri/rawavg.mgz --tval white.deformed --surfreg white --hemi rh
done

# 5.4 BOLD volume
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="hcp_fmri_volume" \
--qunex_options="--sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions --parsessions=1 --overwrite=no" \
--scheduler_options="-l h_data=16G,h_rt=24:00:00,arch=intel*" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual/" \
--array="yes" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

# 5.5 BOLD surface
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="hcp_fmri_surface" \
--qunex_options="--sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions --parsessions=1 --overwrite=no" \
--scheduler_options="-l h_data=16G,h_rt=24:00:00,arch=intel*" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual/" \
--array="yes" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

# 5.6 map hcp data
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="map_hcp_data" \
--qunex_options=" --overwrite=yes --bolds=resting --sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions" \
--scheduler_options="-l h_data=20G,h_rt=1:00:00,arch=intel*" \
--array="yes" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

## 5.7 brain masks
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="create_bold_brain_masks" \
--qunex_options="--overwrite=yes --sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions" \
--scheduler_options="-l h_data=20G,h_rt=1:00:00,arch=intel*" \
--array="yes" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

## 5.8 BOLD stats
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="compute_bold_stats" \
--qunex_options="--overwrite=yes --bolds=resting --sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions" \
--scheduler_options="-l h_data=20G,h_rt=1:00:00,arch=intel*" \
--array="yes" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"
   
## 5.9 create stats report
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="create_stats_report" \
--qunex_options="--overwrite=yes --bolds=resting --sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions" \
--scheduler_options="-l h_data=20G,h_rt=1:00:00,arch=intel*" \
--array="yes" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"
	
## 5.10 extract nuisance signal
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="extract_nuisance_signal" \
--qunex_options="--overwrite=yes --bolds=resting --sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions" \
--scheduler_options="-l h_data=20G,h_rt=1:00:00,arch=intel*" \
--array="yes" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

## 5.11 preprocess BOLD CIFTI no GSR
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="preprocess_bold" \
--qunex_options="--overwrite=no --bolds=resting --bold_actions=s,h,r,c,l --bold_nuisance=m,V,WM,1d --image_target=dtseries --sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions" \
--scheduler_options="-l h_data=20G,h_rt=1:00:00,arch=intel*" \
--array="yes" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

## 5.12 preprocess BOLD CIFTI GSR
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="preprocess_bold" \
--qunex_options="--overwrite=no --bolds=resting --bold_actions=s,h,r,c,l --bold_nuisance=m,V,WM,WB,1d --image_target=dtseries --sessions=/u/project/cbearden/data/22q/qunex_studyfolder/processing/22qTrio_post_long_batch.txt --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions" \
--scheduler_options="-l h_data=20G,h_rt=1:00:00,arch=intel*" \
--array="yes" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual" \
--sessions="Q_0001_09242012 Q_0001_10152010 Q_0005_04182011 Q_0007_04012011 Q_0009_09292011 Q_0016_03292011 Q_0016_10082012 Q_0019_05052011 Q_0020_03262012 Q_0020_05052011 Q_0021_01132011 Q_0021_11052012 Q_0024_04152011 Q_0024_09212012 Q_0026_03232012 Q_0026_05032013 Q_0033_03192010 Q_0036_03302010 Q_0036_06212012 Q_0036_06282011 Q_0037_04202011 Q_0038_06042010 Q_0039_04132010 Q_0039_06012011 Q_0040_05142010 Q_0040_06272011 Q_0041_09262012 Q_0045_07132010 Q_0045_08302011 Q_0045_10052012 Q_0051_01302012 Q_0052_07302010 Q_0053_08022010 Q_0053_12212012 Q_0054_08062010 Q_0056_08252010 Q_0056_09102012 Q_0059_08032011 Q_0062_11302011 Q_0076_10212010 Q_0077_02292012 Q_0077_03112013 Q_0077_10252010 Q_0078_11102011 Q_0080_11222010 Q_0081_11242010 Q_0082_01062012 Q_0082_01112013 Q_0082_12162010 Q_0085_02242012 Q_0091_03052012 Q_0091_03072011 Q_0092_03102011 Q_0093_03082011 Q_0093_03122012 Q_0093_03122013 Q_0098_04012011 Q_0099_04012011 Q_0100_04082011 Q_0101_01032013 Q_0101_04122011 Q_0102_01032013 Q_0102_04122011 Q_0103_04182011 Q_0103_08272012 Q_0105_05022011 Q_0109_05262011 Q_0112_11142012 Q_0114_02062014 Q_0114_11092012 Q_0117_07062011 Q_0117_08312012 Q_0118_07072011 Q_0124_07292011 Q_0124_09172012 Q_0126_08012011 Q_0127_03052013 Q_0127_08012014 Q_0127_08082011 Q_0130_08132012 Q_0130_08162011 Q_0130_11042014 Q_0132_08222011 Q_0135_09012011 Q_0136_09012011 Q_0137_09022011 Q_0138_09032013 Q_0138_09042012 Q_0138_09062011 Q_0141_10072013 Q_0141_10092012 Q_0146_11082012 Q_0146_12072011 Q_0147_08112015 Q_0147_08142014 Q_0147_12122011 Q_0149_11192012 Q_0149_12192011 Q_0150_11192012 Q_0150_12202011 Q_0151_01122012 Q_0153_01202012 Q_0156_01312012 Q_0156_12102013 Q_0157_01312012 Q_0159_02122013 Q_0161_03012012 Q_0161_04192013 Q_0162_03202012 Q_0163_03262012 Q_0166_01092014 Q_0166_04052012 Q_0168_04052012 Q_0169_04062012 Q_0170_04102012 Q_0170_11252014 Q_0171_04102012 Q_0171_11252014 Q_0172_04122012 Q_0172_04262013 Q_0173_04122012 Q_0173_04172014 Q_0173_04262013 Q_0174_04182012 Q_0174_04272015 Q_0176_04242012 Q_0176_05072013 Q_0177_05012012 Q_0178_05012012 Q_0182_05182012 Q_0184_05242012 Q_0185_05242012 Q_0186_04092015 Q_0188_05242012 Q_0189_05242012 Q_0190_06012012 Q_0190_08132013 Q_0192_06112013 Q_0196_06192015 Q_0196_06202012 Q_0196_09122013 Q_0200_04032015 Q_0200_07092012 Q_0200_08052013 Q_0213_08032012 Q_0215_08062012 Q_0215_08172015 Q_0216_08062012 Q_0216_08172015 Q_0217_01142014 Q_0217_02042015 Q_0217_08092012 Q_0219_08122014 Q_0219_08162012 Q_0219_09012015 Q_0222_08212012 Q_0223_08212012 Q_0227_10032012 Q_0228_01292014 Q_0228_09272012 Q_0229_10022012 Q_0232_12122012 Q_0234_03252014 Q_0234_12132012 Q_0236_03072013 Q_0238_03202013 Q_0238_08042014 Q_0238_11132015 Q_0240_03232015 Q_0240_03272013 Q_0240_06262014 Q_0242_03272013 Q_0242_05162016 Q_0244_09162013 Q_0244_09232014 Q_0246_09242013 Q_0252_12102013 Q_0255_10212014 Q_0260_06092014 Q_0260_10262015 Q_0266_08122014 Q_0268_10132014 Q_0269_10142014 Q_0277_12082014 Q_0284_03182015 Q_0285_03182015 Q_0286_03182015 Q_0287_03182015 Q_0291_04172015 Q_0307_10132015 Q_0310_11182015 Q_0311_12082015 Q_0315_01262016 Q_0321_03232016 Q_0322_03312016 Q_0326_04142016 Q_0327_04142016 Q_0328_04262016"

# final check for check GSR and noGSR for everything in sessions dir
cd /u/project/cbearden/data/22q/qunex_studyfolder/post_long_sessions
sessions=Q_*
echo GSR
for i in $sessions; do if [[ -f ${i}/images/functional/bold1_Atlas_s_hpss_res-mVWMWB1d_lpss.dtseries.nii  ]] || [[ -f ${i}/images/functional/bold2_Atlas_s_hpss_res-mVWMWB1d_lpss.dtseries.nii  ]]|| [[ -f ${i}/images/functional/bold3_Atlas_s_hpss_res-mVWMWB1d_lpss.dtseries.nii  ]]|| [[ -f ${i}/images/functional/bold4_Atlas_s_hpss_res-mVWMWB1d_lpss.dtseries.nii  ]]; then echo ${i} has processed BOLD; else echo ${i} MISSING; fi; done
echo noGSR
for i in $sessions; do if [[ -f ${i}/images/functional/bold1_Atlas_s_hpss_res-mVWM1d_lpss.dtseries.nii  ]] || [[ -f ${i}/images/functional/bold2_Atlas_s_hpss_res-mVWM1d_lpss.dtseries.nii  ]]|| [[ -f ${i}/images/functional/bold3_Atlas_s_hpss_res-mVWM1d_lpss.dtseries.nii  ]]|| [[ -f ${i}/images/functional/bold4_Atlas_s_hpss_res-mVWM1d_lpss.dtseries.nii  ]]; then echo ${i} has processed BOLD; else echo ${i} MISSING; fi; done























#####################################################################
### test with single subject
#####################################################################

# set up dirs and files
# test subject = Q_0039; Q_0039_04132010 Q_0039_06012011
origdir="/u/project/cbearden/data/22q/qunex_studyfolder/sessions"
longdir="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
subjects="Q_0039_04132010 Q_0039_06012011"
for subj in $subjects; do 
	#mkdir -p ${longdir}/${subj}/hcp/${subj}/
	# get subject id
	#subjid <- ${subj%_*}
	# copy entire T1w freesurfer directory from original sessions
	cp -rv ${origdir}/${subj}/hcp/${subj}/T1w/${subj} ${longdir}
done


### FS long
# https://surfer.nmr.mgh.harvard.edu/fswiki/LongitudinalProcessing
# 1. cross-sectionally process all time points with the default workflow
# E.g. recon-all -all -s <tpNid> -i path_to_tpN_dcm
# recon-all was run as part of qunex hcp2, copied over T1w folder to start from

# 2. create an unbiased template from all time points for each subject and process it with recon-all:
# E.g. recon-all -base <templateid> -tp <tp1id> -tp <tp2id> ... -all
# run within qunex to keep FS version and OS the same
# testing interactively. TO-DO submit container FS jobs to scheduler
# failed because looking for /u/project/cbearden/data/22q/qunex_studyfolder/long_sessions/Q_0039_06012011/mri/norm.mgz
# working after using a subject directory containing only the standard recon-all dirs e.g. ${subj}/hcp/${subj}/T1w/${subj} 
#SUBJECTS_DIR="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
#recon-all -base Q_0039 -tp Q_0039_04132010 -tp Q_0039_06012011 -all
# timed out running interactively -- base creation step needs several hours to run all of recon-all 

## submit through scheduler in qunex container (rather than test interactively)
# set up temp file to be run in container
SUBJECTS_DIR="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
fs_command="recon-all -base Q_0039 -tp Q_0039_04132010 -tp Q_0039_06012011 -all"
fstmp=~/"fstmp"
cfstmp=~/"cfstmp"
echo "...writing temporary freesurfer command file:"
echo "source /opt/qunex/env/qunex_environment.sh" > ${fstmp}
echo "SUBJECTS_DIR=${SUBJECTS_DIR}" >> ${fstmp}
echo "${fs_command}" >> ${fstmp}
echo "rm ${fstmp}" >> ${fstmp}
echo "rm ${cfstmp}" >> ${fstmp}
cat ${fstmp}
# set up temp file to to create container
echo "...writing temporary singularity command file:"
echo "source /u/local/Modules/default/init/modules.sh" > ${cfstmp}
echo "module load singularity"    >> ${cfstmp}
echo "fstmp=fstmp" >> ${cfstmp}
#echo "qfiles=(${qfiles[@]})"     >  ${cfstmp}
#echo "n=\$((\$SGE_TASK_ID - 1))" >> ${cfstmp}
#echo "qfile=\${qfiles[\$n]}"     >> ${cfstmp}
echo "singularity exec --userns /u/project/cbearden/data/scripts/tools/qunex_suite-0.90.6/ bash ~/\${fstmp}" >> ${cfstmp}
cat ${cfstmp}
# submit to scheduler
length=1
#length=${#seshArray[@]}
qsub -cwd -V -N fslong.step2.base -o ${SUBJECTS_DIR}/fs_logs -e ${SUBJECTS_DIR}/fs_logs -t 1-${length}:1 -l h_data=16G,h_rt=48:00:00,highp $cfstmp


# 3. "-long" longitudinally process all timepoints:
# E.g. recon-all -long <tpNid> <templateid> -all
#recon-all -long Q_0039_04132010 Q_0039 -all
#recon-all -long Q_0039_06012011 Q_0039 -all
origdir="/u/project/cbearden/data/22q/qunex_studyfolder/sessions"
longdir="/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions"
# read list back as array
sesh_array=(Q_0039_04132010 Q_0039_06012011)
SUBJECTS_DIR=${longdir}
fstmp=~/"fstmp"
cfstmp=~/"cfstmp"
echo "...writing temporary freesurfer command file:"
# lines below write temporary code to be execited in container
# first source qunex environment
echo "source /opt/qunex/env/qunex_environment.sh" > ${fstmp}
# set FS subjects dir in the container based on subjects dir in current shell
echo "SUBJECTS_DIR=${SUBJECTS_DIR}" >> ${fstmp}
# read subject list into array
echo "sesh_array=(Q_0039_04132010 Q_0039_06012011)" >> ${fstmp}
# get SGE_TASK_ID passed as arg1 from submitting script
echo "sge_i=\$1" >> ${fstmp}
# array starts at 0, sge index starts at 1
echo "n=\$((\${sge_i} - 1))" >> ${fstmp}
# get subject based on sge index
echo "sesh=\${sesh_array[\$n]}" >> ${fstmp}
echo "sub=\${sesh%_*}" >> ${fstmp}
# construct freesurfer command
echo "fs_command=\"recon-all -long \${sesh} \${sub} -all\"" >> ${fstmp}
# run freesurfer command
echo "\${fs_command}" >> ${fstmp}
# cleanup
echo "echo \" \" > ${fstmp}" >> ${fstmp}
echo "echo \" \" > ${cfstmp}" >> ${fstmp}
# now set up temp file to to create container
echo "...writing temporary singularity command file:"
# check that SGE_TASK_ID is set
echo "if [[ -z \$SGE_TASK_ID ]];then echo \"SGE_TASK_ID empty. Make sure you are submitting as array\"; exit 0;fi" > ${cfstmp}
# make sure singularity is loaded
echo "source /u/local/Modules/default/init/modules.sh" >> ${cfstmp}
echo "module load singularity"    >> ${cfstmp}
# run fstmp code in singularity container and give it sge index as arg1 
echo "singularity exec --userns /u/project/cbearden/data/scripts/tools/qunex_suite-0.90.6/ bash ~/fstmp $SGE_TASK_ID" >> ${cfstmp}
# print code
echo "Code to be run inside the container:"
cat ${fstmp}
echo ""
echo "Code to create container:"
cat ${cfstmp}
# submit array to schedulerlength=1
length=${#sesh_array[@]}
qsub -cwd -V -N fslong.step3.long -o ${SUBJECTS_DIR}/fs_logs -e ${SUBJECTS_DIR}/fs_logs -t 1-${length}:1 -l h_data=16G,h_rt=48:00:00,highp $cfstmp


### continue QuNex hcp3 onwards using recon-all long outputs
# Need to figure out the specific inputs hcp3 needs, and if there are any intermediate steps needed after recon-all long
# first copy necessary data for one session to test_sessions, run hcp1-5 and record all filenames after each step to know what is generated when
mkdir -p /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/Q_0039_04132010/hcp/Q_0039_04132010/ 
cp -rv /u/project/cbearden/data/22q/qunex_studyfolder/sessions/Q_0039_04132010/hcp/Q_0039_04132010/unprocessed /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/Q_0039_04132010/hcp/Q_0039_04132010/ 

cp /u/project/cbearden/data/22q/qunex_studyfolder/sessions/specs/22q_trio_params.txt /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/22q_trio_test_batch.sh
echo "---" >> /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/22q_trio_test_batch.sh
cat /u/project/cbearden/data/22q/qunex_studyfolder/sessions/Q_0039_04132010/session_hcp.txt | sed 's/sessions/test_sessions/' >> /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/22q_trio_test_batch.sh

# record list of files in hcp dir prior to hcp1
#find /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/Q_0039_04132010/hcp > /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_before_hcp1.txt

# hcp1
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="hcp_pre_freesurfer" \
--qunex_options="--sessions=/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/22q_trio_test_batch.sh --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions --parsessions=1 --overwrite=no" \
--scheduler_options="-l h_data=16G,h_rt=24:00:00" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual/" \
--array="yes" \
--sessions="Q_0039_04132010"

# record list of files in hcp dir after hcp1
#find /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/Q_0039_04132010/hcp > /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp1.txt
cat /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp1.txt | sed 's/\/u\/project\/cbearden\/data\/22q\/qunex_studyfolder\/test_sessions\/Q_0039_04132010\///g' >  /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp1_general.txt

# hcp2
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="hcp_freesurfer" \
--qunex_options="--sessions=/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/22q_trio_test_batch.sh --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions --parsessions=1 --overwrite=no" \
--scheduler_options="-l h_data=16G,h_rt=24:00:00" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual/" \
--array="yes" \
--sessions="Q_0039_04132010"

# record list of files in hcp dir after hcp2
#find /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/Q_0039_04132010/hcp > /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp2.txt
cat /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp2.txt | sed 's/\/u\/project\/cbearden\/data\/22q\/qunex_studyfolder\/test_sessions\/Q_0039_04132010\///g' >  /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp2_general.txt
cat /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp2.txt | grep "hcp/Q_0039_04132010/T1w/Q_0039_04132010" | sed 's/\/u\/project\/cbearden\/data\/22q\/qunex_studyfolder\/test_sessions\/Q_0039_04132010\/hcp\/Q_0039_04132010\/T1w\/Q_0039_04132010\///g' >  /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp2_general_fs.txt

# hcp3
/u/project/cbearden/data/scripts/tools/qunex_bin/hoffman_submit_qunex.sh \
--qunex_command="hcp_post_freesurfer" \
--qunex_options="--sessions=/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/22q_trio_test_batch.sh --sessionsfolder=/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions --parsessions=1 --overwrite=no" \
--scheduler_options="-l h_data=16G,h_rt=24:00:00" \
--logdir="/u/project/cbearden/data/22q/qunex_studyfolder/processing/logs/manual/" \
--array="yes" \
--sessions="Q_0039_04132010"

# record list of files in hcp dir after hcp3
#find /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/Q_0039_04132010/hcp > /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp3.txt

# record list of files after fs long
find /u/project/cbearden/data/22q/qunex_studyfolder/long_sessions/Q_0039_04132010 > /u/project/cbearden/data/22q/qunex_studyfolder/long_sessions/files_after_fslong.txt
cat /u/project/cbearden/data/22q/qunex_studyfolder/long_sessions/files_after_fslong.txt | sed 's/\/u\/project\/cbearden\/data\/22q\/qunex_studyfolder\/long_sessions\/Q_0039_04132010.long.Q_0039\///g' >  /u/project/cbearden/data/22q/qunex_studyfolder/long_sessions/files_after_fslong_general.txt


# now open a python terminal to determine which files are generated after which step
module load anaconda3
python
import sys
import csv
import string
import pandas as pd
pd.set_option('display.max_columns', None) 
pd.set_option('display.max_rows', None)  
pd.set_option('display.max_colwidth', None)  
hcp1=pd.read_table('/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp1_general.txt',header=None)
#hcp2=pd.read_table('/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp2_general.txt',header=None)
hcp2fs=pd.read_table('/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp2_general_fs.txt',header=None)
#hcp3=pd.read_table('/u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/specs/files_after_hcp3.txt',header=None)
fslong=pd.read_table('/u/project/cbearden/data/22q/qunex_studyfolder/long_sessions/files_after_fslong_general.txt',header=None)
#hcp2_notin1=pd.concat([hcp1,hcp2]).drop_duplicates(keep=False)
#hcp3_notin2=pd.concat([hcp2,hcp3]).drop_duplicates(keep=False)
fslong_hcp2_diff=pd.concat([hcp2fs,fslong]).drop_duplicates(keep=False)
# print files after hcp2 that weren't there after hcp1
#print(hcp2_notin1)
print(fslong_hcp2_diff)
# only files are in hcp/$sub/T1w/$sub
# appears to be just the standard freesurfer output directories plus the link /u/project/cbearden/data/22q/qunex_studyfolder/test_sessions/Q_0039_04132010/hcp/Q_0039_04132010/T1w/fsaverage -> /opt/freesurfer/freesurfer-6.0/subjects/fsaverage
## copy over hcp1 results to post_long directory
#hcp1.replace("Q_0039_04132010","TEST",regex=True)
